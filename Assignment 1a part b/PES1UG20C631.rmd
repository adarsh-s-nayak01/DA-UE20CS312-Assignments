---
title: "\n**UE20CS631 - Data Analytics**\n\n**Worksheet 1a - Part 2: Exploring Data
  with R**\n\nSRN - PES1UG20CS631\nNAME - BASAVA PRABHU\nWORKSHEET 1A PART 1\n"
output:
  word_document: default
  pdf_document:
    fig_width: 4
    fig_height: 4
urlcolor: blue
editor_options:
  markdown:
    wrap: 72
---

Name: BASAVA PRABHU   
SRN : PES1UG20CS631
## 1. About the Data: Top 1000 Instagrammers

**Data Dictionary**

    Name: Name of the account
    Rank: Overall rank in the world.
    Category: Stream of the account (Music, Games, etc..)
    Followers: Number of followers
    Audience Country: country of the majority of audience.
    Authentic Engagement: Engagement with the users.
    Engagement Avg.: Average engagement of the users.

\pagebreak


##Loading the Dataset

**Step 1:** Working Directory

```{r}
# Get and print current working directory
print(getwd())
```

**Step 2:** Reading CSV File
```{r}
# Load CSV
library(tidyverse)
data <- read.csv("top_1000_instagrammers.csv")
data <- read.csv('top_1000_instagrammers.csv', header=TRUE)

df <- read_csv("top_1000_instagrammers.csv")

#print(data)
```

##Compact Summary
Displays data type and value of all the attributes.
  
```{r}
  str(data) 
```

##Remove NaN Values
Remove missing or null values to obtain better inferences
```{r}
data=data[!(is.na(data$Name) | data$Name==""),]
data=data[!(is.na(data$Rank) | data$Rank==""),]
data=data[!(is.na(data$Followers) | data$Followers==""),]
data=data[!(is.na(data$Category) | data$Category==""),]
data=data[!(is.na(data$Audience.Country) | data$Audience.Country==""),]
data=data[!(is.na(data$Authentic.Engagement) | data$Authentic.Engagement==""),]
data=data[!(is.na(data$Engagement.Avg.) | data$Engagement.Avg.==""),]
#print(data)
```

\pagebreak

## Problems

##Problem 1 (1 point)

1. AUTHENTIC ENGAGEMENT  
```{r}

sapply(df,class)
a<- df[["Authentic Engagement"]]
a <- ifelse(grepl('m', ignore.case = TRUE, a), as.numeric(gsub("[$M]", "", a)) * 10^6,
                      as.numeric(gsub("[$K]", "", a)) * 10^3)

## MEAN
mean(a)
## MEDIAN
median(a)
## MODE
getmode <- function(v) {
   uniqv <- unique(v)
   uniqv[which.max(tabulate(match(v, uniqv)))]
}
getmode(a)
## MINIMUM VALUE 
min(a)
## MAXIMUM VALUE
max(a)
## 1ST QUARTILE
quantile(a, 0.25)
## 3RD QUARTILE
quantile(a, 0.75)
## STANDARD DEVIATION
sd(a)
```

2. ENGAGEMENT AVG.
```{r}
b<-df[["Engagement Avg."]]
b <- ifelse(grepl('m', ignore.case = TRUE, b), as.numeric(gsub("[$M]", "", b)) * 10^6,
                      as.numeric(gsub("[$K]", "", b)) * 10^3)

#### MEAN
mean(b)
#### MEDIAN
median(b)
#### MODE
getmode(b)
#### MINIMUM VALUE
min(b)
#### MAXIMUM VALUE
max(b)
#### 1ST QUARTILE
quantile(b, 0.25)
#### 3RD QUARTILE
quantile(b, 0.75)
#### STANDARD DEVIATION
sd(b)
```

3. Followers

```{r}
c<-df[["Followers"]]
c<- ifelse(grepl('m', ignore.case = TRUE, b), as.numeric(gsub("[$M]", "", b)) * 10^6,
                      as.numeric(gsub("[$K]", "", b)) * 10^3)

#### MEAN
mean(c)
#### MEDIAN
median(c)
#### MODE
getmode(c)
#### MINIMUM VALUE
min(c)
#### MAXIMUM VALUE
max(c)
#### 1ST QUARTILE
quantile(c, 0.25)
#### 3RD QUARTILE
quantile(c, 0.75)
#### STANDARD DEVIATION
sd(c)
```

### Problem 2 (2 points)

What are the top 3 audience countries that follow most of the top 1000 instagrammers? *Hint:* Go back to bar graph created earlier. Use R to calculate the percentage of the top 1000 instagrammers that have the top 1 audience country.

```{r}
freq_table_country=table(data$Audience.Country)#Create table with Countries and their occurence
sort_table=freq_table_country[order(freq_table_country,decreasing=TRUE)]#Sorting the distribution
print(sort_table[1:3])
cat("Percentage of the top 1000 instagrammers that have the top 1 audience country is ",sort_table[1]/sum(sort_table))
```
```{r}
library(ggplot2)
ggplot(data,aes(x=Audience.Country))+geom_bar()+coord_flip()+ggtitle("Countries with their frequency distribution")
```
### Problem 3 (1 point)

Create a horizontal box plot using the column `Authentic.Engagement`. What inferences can you make from this box and whisker plot?data$Authentic.Engagement

```{r}
#as defined above--> a<- df[["Authentic Engagement"]]
boxplot(a , xlab = "Authentic Engagement", border = "black", 
ylab = "All top 1000 Instagrammers") 

```
##Observations from box plot:
It is observed that few of the points happen to be as outliers.This implies that there is a slight variability in the measurement or may indicate slight fluctuations or experimental error.


```
##Analysis
Creating a histogram is a obstacle as the one of the axis comprises Categorical values.
Rather,I have created a  bar plot,vertical being the Audience Country and horizontal being the corresponding total followers of that particular country.
It is observed from the plot that,**United states** has the maximum followers of all the artists/influencers combined together possibly owing to the same country being the modal country to the attribute Audience Country,
In the second position is India comprising of 5+e06 plus followers and third being Brazil.

This is majorly because the above three countries have been the lead in having maximum Audiences.

```{r}
subset(data,Followers==528400000)
```
The account **Instagram** has maximum followers of **528400000** with its majority audience belonging to **India** and ranks as 1.


\n
## Conclusion (1 point)

In a few short sentences, describe your Instagram profile (category, followers, estimated engagement). Compare your profile to the analysis done of the top 1000 profiles. If you were tasked to becoming an influencer, what would be the best way for you to increase your followers and user engagement?
**Final Remarks**
* CONCLUSION:
BASVAVAPRABHU 's Instagram profile:
* Category: PRIVATE ACCOUNT
* I HAVENT POSTED ANY PICTURES, BECUASE I DONT WANT TO.(IM UGLY AND MODEST XD)
* FOLLOWERS: 1068 
* FOLLOWING: 786
* I DONT THINK I'LL EVER BE AN INFLUNCER, AS I LACK THAT KIND OF CONFIDENCE. ALTHOUGH IF I DID TRY TO BECOME ONE
I WOULD POST ABOUT F1, FOOTBALL AS I AM REALLY PASSIONATE ABOUT THE. I WOULD ALSO OCCASIONALLY POST MY DRAWINGS, WHICH IS ANOTHER THING I EXCEL AT.

